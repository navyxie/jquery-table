var NAVY=NAVY||{},console=console||{log:function(){}};NAVY.Table=function(t,n,a,e){var s={sortable:[],ths:[],skip:{},changeHanlder:function(t){console.log(t)},isFixHead:!0,footHtml:""};this.docs=a.length?a:[],this.sourceData=n.length?n:[{}],this.sourceDataKeys=this.getKey(this.sourceData[0]),this.jqObj=$(t),$.extend(s,e),this.options=s,this.init()},NAVY.Table.prototype={init:function(){return this.makeTableHtml(),this.initEvent(),this},initEvent:function(){var t=this.jqObj,n=this,a=n.options,e=t.find(".navyTable"),s=e.find(".navyTbody"),o=e.find("th"),r=e.find(".navyTableTr"),i=r.length;return t.on("click",".sortAble",function(){var t=$(this);if(t.hasClass("sortAble")){for(var a=o.index(t),e=0,l=t.hasClass("desc");i>e;e++)r[e].compareValue=$(r[e]).find("td").eq(a).text();r.sort(function(t,n){return l?n.compareValue-t.compareValue:t.compareValue-n.compareValue}),r=n.resetEvenAndOdd(r),s.append(r),t.hasClass("desc")?t.removeClass("desc").addClass("asc"):t.removeClass("asc").addClass("desc")}}).on("blur",".contentContainer",function(){var t=$(this);return t.hasClass("contentContainer")&&(t.removeAttr("contentEditable"),n.onChangeHanlder(t)),!1}).on("dblclick",".contentContainer",function(){var t=$(this);return t.hasClass("contentContainer")&&t.attr("contentEditable",!0),!1}),a.isFixHead&&e.find(".navyThead").addClass("fixed"),this},resetEvenAndOdd:function(t){for(var n=0,a=t.length;a>n;n++){var e=$(t[n]);0===(n+1)%2?e.hasClass("odd")&&e.removeClass("odd").addClass("even"):e.hasClass("even")&&e.removeClass("even").addClass("odd")}return t},makeTableHtml:function(){var t=this.docs,n=$.makeArray(t),a=[],e=this.options,s=e.sortable,o=e.skip,r=s.length,i=[];a.push('<table class="navyTable">'),t=$.isArray(t)?t:$.isArray(n)?n:[];var l,d=0,h=t.length,c=t[0];for(var v in c)!o[v]&&i.push(v);for(l=i.length,$.extend(i,e.ths),a.push('<thead class="navyThead">'),d=0;l>d;d++){for(var u="",f=0;r>f;f++)if(s[f]===d){u="sortAble";break}a.push('<th class="navyTableTh navyTableTh'+d+" "+u+'"><div class="thContainer">'+i[d]+'</div><div class="arrowContainer upArrow hidden">↑</div><div class="arrowContainer downArrow hidden">↓</div></th>')}for(a.push('</thead><tbody class="navyTbody">'),d=0;h>d;d++){c=t[d];var b=0;if($.isPlainObject(c)&&!$.isEmptyObject(c)){var p="odd";0===(d+1)%2&&(p="even"),a.push('<tr class="navyTableTr '+p+'">');for(var y in c)a.push('<td td-class="'+y+'" class="'+(o[y]||"")+" navyTableTd "+y+" navyTableTd"+b++ +'"><div class="contentContainer">'+c[y]+"</div></td>");a.push("</tr>")}}var C=e.footHtml?'<tfoot class="navyTableFoot"><tr><th colspan="'+l+'"><p class="footContainer">'+e.footHtml+"</p></th></tr></tfoot>":"";return a.push("</tbody>"+C+"</table>"),this.jqObj.append(a.join("")),this},getKey:function(t){var n=[];for(var a in t)n.push(a);return n},onChangeHanlder:function(t){var n={},a={},e=this.sourceDataKeys,s=e.length,o=t.parent();n[o.attr("td-class")]=t.html();for(var r=o.siblings(".navyTableTd"),i=0,l=r.length;l>i;i++){var d=$(r[i]);n[d.attr("td-class")]=d.find(".contentContainer").html()}for(i=0;s>i;i++)a[e[i]]=n[e[i]];this.options.changeHanlder(a)},destroy:function(){return this.jqObj.unbind().empty(),this},getTableHtml:function(){return this.jqObj.html()}};